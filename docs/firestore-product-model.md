# Firestore Data Model: Products

This document outlines the recommended data model for storing products in a Cloud Firestore collection named `products`.

## Collection: `products`

Each document in this collection represents a single product. The document ID can be auto-generated by Firestore or a custom ID (e.g., product SKU if guaranteed unique).

### Fields:

| Field Name        | JSON Key (Original) | Firestore Type        | Description                                                                 | Indexing Recommendation                                                                                                                               |
|-------------------|---------------------|-----------------------|-----------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------|
| `code`            | `code`              | `string`              | Unique product identifier or SKU.                                           | **Yes (Single)**: For direct lookups or filtering if users can search/filter by code.                                                                  |
| `gtin13`          | `gtin13`            | `string`              | Global Trade Item Number (13-digit EAN/UPC). Stored as string for leading zeros. | **Yes (Single, Optional)**: If searching/filtering by GTIN is a requirement.                                                                            |
| `name`            | `name`              | `string`              | Primary display name of the product.                                        | **Yes (Single/Composite)**: For searching (basic equality/prefix) and sorting. For advanced text search, consider a dedicated search service.         |
| `title`           | `tittle`            | `string`              | The title of the product, possibly for display or longer descriptions.    | **Yes (Single/Composite, Optional)**: Similar to `name`, if used for display and searching.                                                               |
| `measure`         | `measure`           | `string`              | Unit of measure or size (e.g., "DN50", "1/2 inch", "Kg").                 | **Yes (Single, Optional)**: If filtering by specific measures is common.                                                                                |
| `seoTitle`        | `seotittle`         | `string`              | SEO-optimized title for search engines.                                     | **No (Typically)**: Usually not queried directly by the app.                                                                                           |
| `description`     | `description`       | `string`              | Detailed product description. Can be long.                                  | **No (Typically for full-text)**: Firestore is not ideal for full-text search on long strings. For keyword matching, a search service is better.          |
| `category`        | `category`          | `string`              | Product category (e.g., "VÃ¡lvula", "Racor"). (Consider `DocumentReference` to a `categories` collection for relational data). | **Yes (Single)**: Crucial for filtering products by category.                                                                                          |
| `brand`           | `brand`             | `string`              | Product brand. (Consider `DocumentReference` to a `brands` collection).        | **Yes (Single, Optional)**: For filtering by brand.                                                                                                  |
| `dimensionImage`  | `dimensionimage`    | `string`              | URL of an image showing product dimensions.                                 | **No**: URLs are generally not indexed for querying.                                                                                                    |
| `dimensionData`   | `dimensiondata`     | `array` of `map`      | Structured dimension information. Each map: `{ label: string, value: string }`. | **Yes (Array, Optional)**: For `array-contains` or `array-contains-any` queries if needing to find products by specific dimension labels or values.   |
| `images`          | `images`            | `array` of `string`   | List of URLs for primary product images.                                    | **No**: URLs are generally not indexed.                                                                                                                |
| `imagesRelated`   | `imagerelated`      | `array` of `string`   | List of URLs for images of related products or accessories.                 | **No**: URLs are generally not indexed.                                                                                                                |
|                   |                     |                       |                                                                             |                                                                                                                                                       |
| **Recommended Additional Fields:** |                     |                       |                                                                             |                                                                                                                                                       |
| `price`           | N/A                 | `number`              | Product price. Store in the smallest currency unit (e.g., cents) to avoid floating-point issues. | **Yes (Single)**: For sorting by price and range queries.                                                                                               |
| `stock`           | N/A                 | `number`              | Stock quantity.                                                             | **Yes (Single, Optional)**: If filtering by in-stock status or stock levels.                                                                           |
| `isActive`        | N/A                 | `boolean`             | Controls product visibility in the catalog (e.g., published/unpublished).   | **Yes (Single)**: For filtering active/inactive products. Crucial for public listings.                                                                   |
| `createdAt`       | N/A                 | `timestamp`           | Timestamp of when the product document was created.                         | **Yes (Single)**: For sorting by creation date (e.g., "newest products").                                                                              |
| `updatedAt`       | N/A                 | `timestamp`           | Timestamp of when the product document was last updated.                    | **Yes (Single)**: For sorting or tracking recent updates.                                                                                              |


### Notes on Field Types:

*   **`string`**: For text-based data.
*   **`number`**: For numerical data like price (in cents/smallest unit) or stock quantity.
*   **`boolean`**: For true/false flags like `isActive`.
*   **`array`**: For lists, such as image URLs (`array` of `string`) or structured dimension data (`array` of `map`).
*   **`map`**: For structured objects within a document, like items in `dimensionData`.
*   **`timestamp`**: For date and time information, automatically handled by Firestore.
*   **`DocumentReference`**: (Optional, for `category` and `brand`) If you have separate collections for categories and brands, you can store a reference to the document in that collection instead of just a string name. This allows for richer relational data and easier updates if category/brand names change.

### Indexing Strategy:

*   **Single-field indexes**: Firestore automatically creates single-field indexes for all fields (except for array fields by default for range/inequality and map fields). These support exact matches and range queries on that single field.
*   **Composite indexes**: For queries involving multiple fields (e.g., filtering by `category` AND `brand` AND `price < X`, or sorting by `category` then `price`), you will need to manually create composite indexes in the Firebase console. Firestore will often suggest these in error messages when a query fails due to a missing index.
*   **Array Indexing**:
    *   For `array-contains` queries (e.g., find products with `images` array containing a specific URL), Firestore automatically indexes individual array elements.
    *   For `array-contains-any` queries (e.g., find products where `dimensionData` contains an object with `label: "Length"`), you'd typically query on the structured data within the array map.
*   **Full-Text Search**: Firestore's native querying capabilities are not designed for full-text search across large text fields like `description` or `name`. For robust search functionality, integrate with a dedicated search service like Algolia, Typesense, or Elasticsearch, keeping them synced with your Firestore data.

This model provides a solid foundation. You can adjust it based on your specific query patterns and application requirements as they evolve.
